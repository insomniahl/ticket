!function(t){"use strict";var e=t.fn.bootstrapTable.utils.sprintf,o=t.fn.bootstrapTable.utils.objectKeys,i=function(e,o,i){o=t.trim(o),e=t(e.get(e.length-1)),n(e,o)||e.append(t("<option></option>").attr("value",o).text(t("<div />").html(i).text()))},r=function(e){var o=e.find("option:gt(0)");o.sort(function(e,o){return e=t(e).text().toLowerCase(),o=t(o).text().toLowerCase(),t.isNumeric(e)&&t.isNumeric(o)&&(e=parseFloat(e),o=parseFloat(o)),e>o?1:e<o?-1:0}),e.find("option:gt(0)").remove(),e.append(o)},n=function(t,e){for(var o=t.get(t.length-1).options,i=0;i<o.length;i++)if(o[i].value===e.toString())return!0;return!1},a=function(t){t.$tableHeader.css("height","77px")},l=function(t){var e=t.$header;return t.options.height&&(e=t.$tableHeader),e},s=function(t){var e="select, input";return t.options.height&&(e="table select, table input"),e},f=function(e){if(t.fn.bootstrapTable.utils.isIEBrowser()){if(t(e).is("input")){var o=0;if("selectionStart"in e)o=e.selectionStart;else if("selection"in document){e.focus();var i=document.selection.createRange(),r=document.selection.createRange().text.length;i.moveStart("character",-e.value.length),o=i.text.length-r}return o}return-1}return-1},c=function(e,o){t.fn.bootstrapTable.utils.isIEBrowser()&&(void 0!==e.setSelectionRange?e.setSelectionRange(o,o):t(e).val(e.value))},u=function(e){var o=l(e),i=s(e);e.options.valuesFilterControl=[],o.find(i).each(function(){e.options.valuesFilterControl.push({field:t(this).closest("[data-field]").data("field"),value:t(this).val(),position:f(t(this).get(0))})})},p=function(e){var o=null,i=[],r=l(e),n=s(e);e.options.valuesFilterControl.length>0&&r.find(n).each(function(r,n){o=t(this).closest("[data-field]").data("field"),i=t.grep(e.options.valuesFilterControl,function(t){return t.field===o}),i.length>0&&(t(this).val(i[0].value),c(t(this).get(0),i[0].position))})},h=function(){var e=[],o=document.cookie.match(/(?:bs.table.)(\w*)/g);if(o)return t.each(o,function(o,i){/./.test(i)&&(i=i.split(".").pop()),t.inArray(i,e)===-1&&e.push(i)}),e},d=function(e){var o=e.options.data,n=(e.pageTo<e.options.data.length?e.options.data.length:e.pageTo,function(t){return t.filterControl&&"select"===t.filterControl.toLowerCase()&&t.searchable}),a=function(t){return void 0===t.filterData||"column"===t.filterData.toLowerCase()},l=function(t){return t&&t.length>0},s=e.options.pagination?"server"===e.options.sidePagination?e.pageTo:e.options.totalRows:e.pageTo;t.each(e.header.fields,function(f,c){var u=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,c)],p=t(".bootstrap-table-filter-control-"+b(u.field));if(n(u)&&a(u)&&l(p)){0===p.get(p.length-1).options.length&&i(p,"","");for(var h={},d=0;d<s;d++){var v=o[d][c],g=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[f],[v,o[d],d],v);h[g]=v}for(var m in h)i(p,h[m],m);r(p)}})},b=function(t){return String(t).replace(/(:|\.|\[|\]|,)/g,"\\$1")},v=function(e,o){var n,a,l=!1,s=0;t.each(e.columns,function(s,f){if(n="hidden",a=[],f.visible){if(f.filterControl){a.push('<div style="margin: 0 2px 2px 2px;" class="filterControl">');var c=f.filterControl.toLowerCase();f.searchable&&e.options.filterTemplate[c]&&(l=!0,n="visible",a.push(e.options.filterTemplate[c](e,f.field,n)))}else a.push('<div style="height: 34px;"></div>');if(t.each(o.children().children(),function(e,o){if(o=t(o),o.data("field")===f.field)return o.find(".fht-cell").append(a.join("")),!1}),void 0!==f.filterData&&"column"!==f.filterData.toLowerCase()){var u,p,h=y(m,f.filterData.substring(0,f.filterData.indexOf(":")));if(null===h)throw new SyntaxError('Error. You should use any of these allowed filter data methods: var, json, url. Use like this: var: {key: "value"}');u=f.filterData.substring(f.filterData.indexOf(":")+1,f.filterData.length),p=t(".bootstrap-table-filter-control-"+b(f.field)),i(p,"",""),h(u,p);var d,v;switch(h){case"url":t.ajax({url:u,dataType:"json",success:function(t){for(var e in t)i(p,e,t[e]);r(p)}});break;case"var":d=window[u];for(v in d)i(p,v,d[v]);r(p);break;case"jso":d=JSON.parse(u);for(v in d)i(p,v,d[v]);r(p)}}}}),l?(o.off("keyup","input").on("keyup","input",function(t){clearTimeout(s),s=setTimeout(function(){e.onColumnSearch(t)},e.options.searchTimeOut)}),o.off("change","select").on("change","select",function(t){clearTimeout(s),s=setTimeout(function(){e.onColumnSearch(t)},e.options.searchTimeOut)}),o.off("mouseup","input").on("mouseup","input",function(o){var i=t(this),r=i.val();""!==r&&setTimeout(function(){var t=i.val();""===t&&(clearTimeout(s),s=setTimeout(function(){e.onColumnSearch(o)},e.options.searchTimeOut))},1)}),o.find(".date-filter-control").length>0&&t.each(e.columns,function(e,i){void 0!==i.filterControl&&"datepicker"===i.filterControl.toLowerCase()&&o.find(".date-filter-control.bootstrap-table-filter-control-"+i.field).datepicker(i.filterDatepickerOptions).on("changeDate",function(e){t(e.currentTarget).keyup()})})):o.find(".filterControl").hide()},g=function(t){switch(t=void 0===t?"left":t.toLowerCase()){case"left":return"ltr";case"right":return"rtl";case"auto":return"auto";default:return"ltr"}},m={var:function(t,e){var o=window[t];for(var n in o)i(e,n,o[n]);r(e)},url:function(e,o){t.ajax({url:e,dataType:"json",success:function(t){for(var e in t)i(o,e,t[e]);r(o)}})},json:function(t,e){var o=JSON.parse(t);for(var n in o)i(e,n,o[n]);r(e)}},y=function(t,e){for(var o=Object.keys(t),i=0;i<o.length;i++)if(o[i]===e)return t[e];return null};t.extend(t.fn.bootstrapTable.defaults,{filterControl:!1,onColumnSearch:function(t,e){return!1},filterShowClear:!1,alignmentSelectControlOptions:void 0,filterTemplate:{input:function(t,o,i){return e('<input type="text" class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s">',o,i)},select:function(t,o,i){return e('<select class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" dir="%s"></select>',o,i,g(t.options.alignmentSelectControlOptions))},datepicker:function(t,o,i){return e('<input type="text" class="form-control date-filter-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s">',o,i)}},valuesFilterControl:[]}),t.extend(t.fn.bootstrapTable.COLUMN_DEFAULTS,{filterControl:void 0,filterData:void 0,filterDatepickerOptions:void 0,filterStrictSearch:!1,filterStartsWithSearch:!1}),t.extend(t.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"}),t.extend(t.fn.bootstrapTable.defaults.icons,{clear:"glyphicon-trash icon-clear"}),t.extend(t.fn.bootstrapTable.locales,{formatClearFilters:function(){return"Clear Filters"}}),t.extend(t.fn.bootstrapTable.defaults,t.fn.bootstrapTable.locales);var C=t.fn.bootstrapTable.Constructor,T=C.prototype.init,S=C.prototype.initToolbar,w=C.prototype.initHeader,x=C.prototype.initBody,O=C.prototype.initSearch;C.prototype.init=function(){if(this.options.filterControl){var t=this;Object.keys||o(),this.options.valuesFilterControl=[],this.$el.on("reset-view.bs.table",function(){t.options.height&&(t.$tableHeader.find("select").length>0||t.$tableHeader.find("input").length>0||v(t,t.$tableHeader))}).on("post-header.bs.table",function(){p(t)}).on("post-body.bs.table",function(){t.options.height&&a(t)}).on("column-switch.bs.table",function(){p(t)})}T.apply(this,Array.prototype.slice.apply(arguments))},C.prototype.initToolbar=function(){if(this.showToolbar=this.options.filterControl&&this.options.filterShowClear,S.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&this.options.filterShowClear){var o=this.$toolbar.find(">.btn-group"),i=o.find(".filter-show-clear");i.length||(i=t(['<button class="btn btn-default filter-show-clear" ',e('type="button" title="%s">',this.options.formatClearFilters()),e('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.clear),"</button>"].join("")).appendTo(o),i.off("click").on("click",t.proxy(this.clearFilterControl,this)))}},C.prototype.initHeader=function(){w.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&v(this,this.$header)},C.prototype.initBody=function(){x.apply(this,Array.prototype.slice.apply(arguments)),d(this)},C.prototype.initSearch=function(){if(O.apply(this,Array.prototype.slice.apply(arguments)),"server"!==this.options.sidePagination){var e=this,o=t.isEmptyObject(this.filterColumnsPartial)?null:this.filterColumnsPartial;this.data=o?t.grep(this.data,function(i,r){for(var n in o){var a=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,n)],l=o[n].toLowerCase(),s=i[n];if(a&&a.searchFormatter&&(s=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[t.inArray(n,e.header.fields)],[s,i,r],s)),a.filterStrictSearch){if(t.inArray(n,e.header.fields)===-1||"string"!=typeof s&&"number"!=typeof s||s.toString().toLowerCase()!==l.toString().toLowerCase())return!1}else if(a.filterStartsWithSearch){if(t.inArray(n,e.header.fields)===-1||"string"!=typeof s&&"number"!=typeof s||0!==(s+"").toLowerCase().indexOf(l))return!1}else if(t.inArray(n,e.header.fields)===-1||"string"!=typeof s&&"number"!=typeof s||(s+"").toLowerCase().indexOf(l)===-1)return!1}return!0}):this.data}},C.prototype.initColumnSearch=function(t){if(u(this),t){this.filterColumnsPartial=t,this.updatePagination();for(var e in t)this.trigger("column-search",e,t[e])}},C.prototype.onColumnSearch=function(e){if(!(t.inArray(e.keyCode,[37,38,39,40])>-1)){u(this);var o=t.trim(t(e.currentTarget).val()),i=t(e.currentTarget).closest("[data-field]").data("field");t.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),o?this.filterColumnsPartial[i]=o:delete this.filterColumnsPartial[i],this.searchText+="randomText",this.options.pageNumber=1,this.onSearch(e),this.trigger("column-search",i,o)}},C.prototype.clearFilterControl=function(){if(this.options.filterControl&&this.options.filterShowClear){var o=this,i=h(),r=l(o),n=r.closest("table"),a=r.find(s(o)),f=o.$toolbar.find(".search input"),c=0;if(t.each(o.options.valuesFilterControl,function(t,e){e.value=""}),p(o),!(a.length>0))return;if(this.filterColumnsPartial={},t(a[0]).trigger("INPUT"===a[0].tagName?"keyup":"change"),f.length>0&&o.resetSearch(),o.options.sortName!==n.data("sortName")||o.options.sortOrder!==n.data("sortOrder")){var u=r.find(e('[data-field="%s"]',t(a[0]).closest("table").data("sortName")));u.length>0&&(o.onSort(n.data("sortName"),n.data("sortName")),t(u).find(".sortable").trigger("click"))}clearTimeout(c),c=setTimeout(function(){i&&i.length>0&&t.each(i,function(t,e){void 0!==o.deleteCookie&&o.deleteCookie(e)})},o.options.searchTimeOut)}}}(jQuery);