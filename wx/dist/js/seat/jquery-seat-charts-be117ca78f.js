!function(t){t.fn.seatCharts=function(s){if(this.data("seatCharts")){var e=s.legend.items;e.splice(0,e.length),this.empty()}var a=this,n={},i=[],r={animate:!1,naming:{top:!1,left:!0,getId:function(t,s,e){return s+"_"+e},getLabel:function(t,s,e){return e},data:[]},legend:{node:null,items:[]},click:function(){return"available"==this.status()?"selected":"selected"==this.status()?"available":"unavailable"==this.status()?"unavailable":this.style()},focus:function(){return"available"==this.status()?"focused":this.style()},blur:function(){return this.status()},seats:{}},c=function(s,e){return function(a){var i=this;i.settings=t.extend({status:"available",style:"available",data:e.seats[a.character]||{}},a),i.settings.$node=t("<div></div>"),i.settings.$node.attr({id:i.settings.id,role:"checkbox","aria-checked":!1,focusable:!0,tabIndex:-1}).text(i.settings.label).addClass(["seatCharts-seat","seatCharts-cell","available"].concat(i.settings.classes,"undefined"==typeof e.seats[i.settings.character]?[]:e.seats[i.settings.character].classes).join(" ")),i.data=function(){return i.settings.data},i.char=function(){return i.settings.character},i.node=function(){return i.settings.$node},i.style=function(){return 1==arguments.length?function(t){var s=i.settings.style;return t==s?s:(i.settings.status="focused"!=t?t:i.settings.status,i.settings.$node.attr("aria-checked","selected"==t),e.animate?i.settings.$node.switchClass(s,t,200):i.settings.$node.removeClass(s).addClass(t),i.settings.style=t)}(arguments[0]):i.settings.style},i.status=function(){return i.settings.status=1==arguments.length?i.style(arguments[0]):i.settings.status},function(a,r,c){t.each(["click","focus","blur"],function(t,u){i[u]=function(){return"focus"==u&&(void 0!==s.attr("aria-activedescendant")&&n[s.attr("aria-activedescendant")].blur(),s.attr("aria-activedescendant",c.settings.id),c.node().focus()),i.style("function"==typeof a[r][u]?a[r][u].apply(c):e[u].apply(c))}})}(e.seats,i.settings.character,i),i.node().on("click",i.click).on("mouseenter",i.focus).on("mouseleave",i.blur).on("keydown",function(t,e){return function(a){var i;switch(a.which){case 32:a.preventDefault(),t.click();break;case 40:case 38:if(a.preventDefault(),i=function t(s,n,r){var c;return c=s.index(r)||38!=a.which?s.index(r)==s.length-1&&40==a.which?s.first():s.eq(s.index(r)+(38==a.which?-1:1)):s.last(),i=c.find(".seatCharts-seat,.seatCharts-space").eq(n.index(e)),i.hasClass("seatCharts-space")?t(s,n,c):i}(e.parents(".seatCharts-container").find(".seatCharts-row:not(.seatCharts-header)"),e.parents(".seatCharts-row:first").find(".seatCharts-seat,.seatCharts-space"),e.parents(".seatCharts-row:not(.seatCharts-header)")),!i.length)return;t.blur(),n[i.attr("id")].focus(),i.focus(),s.attr("aria-activedescendant",i.attr("id"));break;case 37:case 39:if(a.preventDefault(),i=function(t){return t.index(e)||37!=a.which?t.index(e)==t.length-1&&39==a.which?t.first():t.eq(t.index(e)+(37==a.which?-1:1)):t.last()}(e.parents(".seatCharts-container:first").find(".seatCharts-seat:not(.seatCharts-space)")),!i.length)return;t.blur(),n[i.attr("id")].focus(),i.focus(),s.attr("aria-activedescendant",i.attr("id"))}}}(i,i.node()))}}(a,r);if(a.addClass("seatCharts-container"),t.extend(!0,r,s),r.naming.rows=r.naming.rows||function(t){for(var s=[],e=1;e<=t;e++)s.push(e);return s}(r.map.length),r.naming.columns=r.naming.columns||function(t){for(var s=[],e=1;e<=t;e++)s.push(e);return s}(r.map[0].split("").length),r.naming.top){var u=t("<div></div>").addClass("seatCharts-row seatCharts-header");r.naming.left&&u.append(t("<div></div>").addClass("seatCharts-cell")),t.each(r.naming.columns,function(s,e){u.append(t("<div></div>").addClass("seatCharts-cell").text(e))})}return a.append(u),t.each(r.map,function(s,e){var u=t("<div></div>").addClass("seatCharts-row");r.naming.left&&u.append(t("<div></div>").addClass("seatCharts-cell seatCharts-space").text(r.naming.rows[s])),t.each(e.match(/[a-z_]{1}(\[[0-9a-z_]{0,}(,[0-9a-z_ ]+)?\])?/gi),function(e,a){var d=a.match(/([a-z_]{1})(\[([0-9a-z_ ,]+)\])?/i),h=d[1],l="undefined"!=typeof d[3]?d[3].split(","):[],o=l.length?l[0]:null,f=2===l.length?l[1]:null;u.append("_"!=h?function(t){r.seats[h]=h in r.seats?r.seats[h]:{};var a=o?o:t.getId(h,t.rows[s],t.columns[e]);return n[a]=new c({id:a,label:f?f:t.getLabel(h,t.rows[s],t.columns[e]),row:s,column:e,character:h}),i.push(a),n[a].node()}(r.naming):t("<div></div>").addClass("seatCharts-cell seatCharts-space"))}),a.append(u)}),r.legend.items.length?function(s){var e=(s.node||t("<div></div").insertAfter(a)).addClass("seatCharts-legend"),n=t("<ul></ul>").addClass("seatCharts-legendList").appendTo(e);return t.each(s.items,function(s,e){n.append(t("<li></li>").addClass("seatCharts-legendItem").append(t("<div></div>").addClass(["seatCharts-seat","seatCharts-cell",e[1]].concat(r.classes,"undefined"==typeof r.seats[e[0]]?[]:r.seats[e[0]].classes).join(" "))).append(t("<span></span>").addClass("seatCharts-legendDescription").text(e[2])))}),e}(r.legend):null,a.attr({tabIndex:0}),a.focus(function(){a.attr("aria-activedescendant")&&n[a.attr("aria-activedescendant")].blur(),a.find(".seatCharts-seat:not(.seatCharts-space):first").focus(),n[i[0]].focus()}),a.data("seatCharts",{seats:n,seatIds:i,status:function(){var s=this;return 1==arguments.length?s.seats[arguments[0]].status():function(e,a){return"string"==typeof e?s.seats[e].status(a):function(){t.each(e,function(t,e){s.seats[e].status(a)})}()}(arguments[0],arguments[1])},each:function(t){var s=this;for(var e in s.seats)if(!1===t.call(s.seats[e],e))return e;return!0},node:function(){var s=this;return t("#"+s.seatIds.join(",#"))},find:function(t){var s=this,e=s.set();return 1==t.length?function(t){return s.each(function(){this.char()==t&&e.push(this.settings.id,this)}),e}(t):function(){return t.indexOf(".")>-1?function(){var a=t.split(".");return s.each(function(t){this.char()==a[0]&&this.status()==a[1]&&e.push(this.settings.id,this)}),e}():function(){return s.each(function(){this.status()==t&&e.push(this.settings.id,this)}),e}()}()},set:function s(){var e=this;return{seats:[],seatIds:[],length:0,status:function(){var s=arguments,e=this;return 1==this.length&&0==s.length?this.seats[0].status():function(){t.each(e.seats,function(){this.status.apply(this,s)})}()},node:function(){return e.node.call(this)},each:function(){return e.each.call(this,arguments[0])},get:function(){return e.get.call(this,arguments[0])},find:function(){return e.find.call(this,arguments[0])},set:function(){return s.call(e)},push:function(t,s){this.seats.push(s),this.seatIds.push(t),++this.length}}},get:function(s){var e=this;return"string"==typeof s?e.seats[s]:function(){var a=e.set();return t.each(s,function(t,s){"object"==typeof e.seats[s]&&a.push(s,e.seats[s])}),a}()}}),a.data("seatCharts")}}(jQuery);